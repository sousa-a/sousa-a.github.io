<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Data preparation | Alessandro O. Sousa</title> <meta name="author" content="Alessandro O. Sousa"> <meta name="description" content="Data aquisition, preprocessing/cleaning and ETL"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link href="/assets/css/bootstrap-toc.min.css?6f5af0bb9aab25d79b2448143cbeaa88" rel="stylesheet"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="/projects/1_project/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?e74e74bf055e5729d44a7d031a5ca6a5" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">Alessandro O. Sousa</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">Projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="row"> <div class="col-sm-3"> <nav id="toc-sidebar" class="sticky-top"></nav> </div> <div class="col-sm-9"> <div class="post"> <header class="post-header"> <h1 class="post-title">Data preparation</h1> <p class="post-meta">Alessandro O de Sousa</p> <p class="post-tags"> <a href="/blog/2025"> <i class="fas fa-calendar fa-sm"></i> 2025 </a>   ·   <a href="/blog/tag/data-cleaning"> <i class="fas fa-hashtag fa-sm"></i> Data cleaning</a>   <a href="/blog/tag/etl"> <i class="fas fa-hashtag fa-sm"></i> ETL</a>   <a href="/blog/tag/sql"> <i class="fas fa-hashtag fa-sm"></i> SQL</a>   <a href="/blog/tag/pandas"> <i class="fas fa-hashtag fa-sm"></i> Pandas</a>   <a href="/blog/tag/numpy"> <i class="fas fa-hashtag fa-sm"></i> Numpy</a>   <a href="/blog/tag/seaborn"> <i class="fas fa-hashtag fa-sm"></i> Seaborn</a>   <a href="/blog/tag/matplotblib"> <i class="fas fa-hashtag fa-sm"></i> Matplotblib</a>   <a href="/blog/tag/plotly"> <i class="fas fa-hashtag fa-sm"></i> Plotly</a>   <a href="/blog/tag/power-bi"> <i class="fas fa-hashtag fa-sm"></i> Power BI</a>     ·   <a href="/blog/category/case-study-yellowlynx-medcorp-fictional"> <i class="fas fa-tag fa-sm"></i> Case Study - YellowLynx MedCorp (fictional)</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <hr> <h1 id="case-study-analysis-of-medicine-usage-in-an-integrated-hospital-network-yellowlynx-medcorp---part-1---data-collection-and-preprocessingcleaning">Case Study: Analysis of medicine usage in an integrated hospital network (YellowLynx MedCorp) - Part 1 - Data collection and preprocessing/cleaning.</h1> <p><br> This project consists of a fictional scenario in which a health-related enterprize, YellowLynx MedCorp, needs to closely monitor inventory and stock usage, particularly medicines, across its various hospital departments located in a metropolitan area.<br></p> <p>In this first section, I will focus on the data collection, preprocessing/cleaning aspects of the project.</p> <h2 id="1-business-problem">1. Business problem</h2> <p>YellowLynx MedCorp is a fast-paced growing healthcare company that has closed on the acquisition of two more hospitals. Each hospital had its own enterprise resource planning (ERP) used to manage stock and purchases.<br></p> <p>Also, the nomenclature used for each product is slightly different from hospital to hospital. That is also the case for department’s names.<br></p> <p>YellowLynx MedCorp need to closely monitor inventory and medicine usage in a timely manner using metrics for managerial use in a integrated hospital network.</p> <p>It is necessary to standartize and integrate the information coming from these various sources.</p> <h2 id="2-objectives">2. Objectives</h2> <ol> <li> <p>To demonstrate end-to-end capability in understanding business problems and proposing solutions, always using an analytical mindset and attention to detail.<br></p> </li> <li> <p>To demonstrate proficiency in relational databases, SQL language and Python for data cleaning/preparation, analysis, and insights.<br></p> </li> <li> <p>To demonstrate the ability to integrate and summarize the acquired knowledge in reports, executive summaries, and dashboards that provide relevant information related to inventory management and financial expenditures information to the executive team in a timely and reliable manner.<br><br></p> </li> </ol> <p>Despite being a personal case study, the reports were written using the third person plural, as if it were a team effort.<br><br> <strong>Disclaimer:</strong> The data used in this case study is completely fictional, entirely created by the author and used for educational purposes only. No data was not collected from any existing databases elsewhere.<br><br></p> <h3 id="final-product">Final product</h3> <p>The final product comprises a 4 page Power BI report embed bellow.</p> <iframe title="hospitals" width="850" height="490" src="https://app.powerbi.com/view?r=eyJrIjoiNDJhZGVkZjUtZDI1ZS00NDc5LThkODUtMGYwNDU2OGRhYmZiIiwidCI6IjE2MTMyNTk2LWExMzgtNGM4NS1hYTViLTY0ZDk5YTJlY2U4NyJ9" frameborder="0" allowfullscreen="true"></iframe> <p><br><br></p> <h2 id="3-data-collection-cleaning-and-exploratory-data-analysis-eda-process">3. Data collection, cleaning and Exploratory Data Analysis (EDA) process</h2> <p>The dataset has a primary source, it was provided by the IT department of the company in a zip file containing 5 csv files detailing the stock movement/usage from the pharmacy of each hospital from 2020 to 2023. Each hospital name was replaced by an acronym that describes the size and specialization. There were 3 large-size general hospitals and 2 medium-size specialized hospitals.<br><br></p> <p>     * LGH1: Large-size General Hospital 1<br><br>      * LGH2: Large-size General Hospital 2<br><br>      * LGH3: Large-size General Hospital 3<br><br>      * MSH1: Medium-size Specialized Hospital 1<br><br>      * MSH2: Medium-size Specialized Hospital 2<br><br></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="n">seaborn</span> <span class="k">as</span> <span class="n">sns</span>
<span class="kn">import</span> <span class="n">os</span><span class="p">,</span> <span class="n">sys</span>
<span class="kn">import</span> <span class="n">random</span>
<span class="kn">import</span> <span class="n">string</span>
</code></pre></div></div> <p><br></p> <h3 id="11-data-loading">1.1 Data loading</h3> <p>The provided csv files were loaded into dataframes in a Jupyter Notebook using Python 3.10.9.<br></p> <p>At first glance, it was possible to observe a high variability in the number of features/attributes and nomenclatures for both medicines and department names across different hospitals.<br></p> <p>After an extensive cleaning process, the dataframes were combined into the <em>hospitals_df</em> dataframe.<br></p> <p>This dataset comprises all stock movement/usage history from the pharmacy to each hospital department. It is shown bellow a brief description of each feature found in the cleaned <em>hospitals_df</em> dataframe.<br></p> <p>Each row consists of a stock movement of a product/medicine.<br><br></p> <caption><b>Table 1. Features of the hospitals_df dataframe.</b></caption> <table> <thead> <tr> <th>Index</th> <th>Feature Name</th> <th>Pandas data type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>0</td> <td>SenderLocationID</td> <td>object</td> <td>An acronym that identifies each hospital<br>- LGH1: Large-size General Hospital 1<br>- LGH2: Large-size General Hospital 2<br>- LGH3: Large-size General Hospital 3<br>- MSH1: Medium-size Specialized Hospital 1<br>- MSH2: Medium-size Specialized Hospital 2<br>The hospital’s pharmacy is the medicine supplier for all departments.</td> </tr> <tr> <td>1</td> <td>OrderID</td> <td>object</td> <td>An unique random 12-digit alphanumeric sequence that identifies a specific order by a hospital department.</td> </tr> <tr> <td>2</td> <td>Date</td> <td>datetime64[ns]</td> <td>Specifies the date in which the order was completed.</td> </tr> <tr> <td>3</td> <td>ReceiverID</td> <td>object</td> <td>Consists of the ID the department that receives the medicines for each order.</td> </tr> <tr> <td>4</td> <td>ReceiverName</td> <td>object</td> <td>Consists of the name the department that receives the medicines for each order.</td> </tr> <tr> <td>5</td> <td>InOut</td> <td>object</td> <td>Indicates if the stock movement is “in” or “out”.</td> </tr> <tr> <td>6</td> <td>MovementType</td> <td>object</td> <td>Indicates the type of movement. It can be a “Request”, a “Restock”, an “Adjustment”,<br>a “Disposal of expired product” or “Damaged product”.</td> </tr> <tr> <td>7</td> <td>SKU</td> <td>object</td> <td>Stock Keeping Unit (SKU), consists of a unique random 5-digit numeric sequence that<br>identifies a product/medicine</td> </tr> <tr> <td>8</td> <td>Product</td> <td>object</td> <td>The name of the product/medicine.</td> </tr> <tr> <td>9</td> <td>ClassID</td> <td>object</td> <td>An unique identifier related to the pharmacological class of the medicine.</td> </tr> <tr> <td>10</td> <td>ClassName</td> <td>object</td> <td>The name of the pharmacological class.</td> </tr> <tr> <td>11</td> <td>MeasurementUnit</td> <td>object</td> <td>The measurement unit of the medicine.</td> </tr> <tr> <td>12</td> <td>StandartPrice</td> <td>float64</td> <td>The unit price value.</td> </tr> <tr> <td>13</td> <td>Quantity</td> <td>float64</td> <td>The quantity of units transferred in the order.</td> </tr> <tr> <td>14</td> <td>RemainingStock</td> <td>float64</td> <td>The remaining stock of the product/medicine in the hospital pharmacy.</td> </tr> <tr> <td>15</td> <td>StockValue</td> <td>float64</td> <td>The monetary value obtained by the product between the order’s medicine standard price”<br>and the quantify transferred.</td> </tr> </tbody> </table> <p><br></p> <h3 id="12-column-dropping">1.2 Column dropping</h3> <p>In each dataframe, irrelevant variables were dropped and the dataframes merged into a single one. <br><br></p> <h3 id="13-dataframe-structure-check">1.3 Dataframe structure check</h3> <p>Back in the Jupyter notebook, list comprehensions were used to ensure that dataframes have the same structure and variable/column names.<br></p> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <title>Dataframe structure check</title> <link href="https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-material-dark.min.css" rel="stylesheet"> <details> <summary><b>Click to expand/collapse code</b></summary> <pre class="line-numbers"><code class="language-python">#Load CSV into dataframes
LGH1_fact = pd.read_csv('/Users/alessandro/yellowlynx/primarysource/lgh1.csv',
                        sep='\t', parse_dates=['date','date_modified'])
LGH2_fact = pd.read_csv('/Users/alessandro/yellowlynx/primarysource/lgh2.csv',
                        sep='\t', parse_dates=['date','date_modified'])
LGH3_fact = pd.read_csv('/Users/alessandro/yellowlynx/primarysource/lgh3.csv',
                        sep='\t', parse_dates=['date','date_modified'])
MSH1_fact = pd.read_csv('/Users/alessandro/yellowlynx/primarysource/msh1.csv',
                        sep='\t', parse_dates=['date','date_modified'])
MSH2_fact = pd.read_csv('/Users/alessandro/yellowlynx/primarysource/msh2.csv',
                        sep='\t', parse_dates=['date','date_modified'])

#Drop specific columns
LGH1_fact.drop(columns=['summary', 'date_modified', 'image' 'weight'])
LGH2_fact.drop(columns=['summary', 'tags', 'date_modified'])
LGH3_fact.drop(columns=['Column7', 'date_modified', 'weight'])
MSH1_fact.drop(columns=['tags', 'date_modified',])
MSH2_fact.drop(columns=['summary', 'tags', 'date_modified'])

#Creates a name index for each hospital and a list for the list comprehensions bellow for data validity check
hospital_list = ['LGH1', 'LGH2', 'LGH3', 'MSH1', 'MSH2']
hospitals_data = [LGH1_fact, LGH2_fact, LGH3_fact, MSH1_fact, MSH2_fact]

hospitals_data_shape = pd.DataFrame([x.shape for x in hospitals_data], columns = ['n_rows','n_columns'], index=hospital_list)
hospitals_data_shape.reset_index(inplace=True)
hospitals_data_shape = hospitals_data_shape.rename(columns={'index':'hospital'})

hospitals_data_dtypes = pd.DataFrame([np.dtype(hospitals_data[0]) for x in hospitals_data])

hospitals_data_columns = pd.DataFrame([x.columns for x in hospitals_data], index=hospital_list)
hospitals_data_columns.reset_index(inplace=True)
hospitals_data_columns = hospitals_data_columns.rename(columns={'index':'hospital'})
hospitals_shape_columns = hospitals_data_shape.merge(hospitals_data_columns, how='inner', on='hospital')</code></pre> </details> <script src="https://cdn.jsdelivr.net/npm/prismjs/prism.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-python.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/line-numbers/prism-line-numbers.min.js"></script> <p><br></p> <h3 id="14-nomenclature-standardization">1.4 Nomenclature standardization</h3> <p>Numpy arrays containing unique entries for each variable were created and exported to individual csv files.<br> Extensive analyses conducted in Microsoft Excel allowed the construction of several dictionaries produced to standardize nomenclatures and to allow further transformations<br><br></p> <h3 id="15-data-anonymization">1.5 Data anonymization</h3> <p>Although this is a fictional dataset, we used the random module to generate alphanumeric sequences in order to replace a patient name list created previously using the Faker package (https://faker.readthedocs.io/).<br></p> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <title>Your Page Title</title> <link href="https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-material-dark.min.css" rel="stylesheet"> <details> <summary><b>Click to expand/collapse code</b></summary> <pre class="line-numbers"><code class="language-python">#Merge dataframes and exports it to a csv
directory = '/Users/alessandro/yellowlynx/'
hospitals_df = pd.DataFrame()
for filename in os.listdir(directory):
    if filename.endswith('.csv'):
        df = pd.read_csv(os.path.join(directory, filename))
        master_df = master_df.append(df, ignore_index=True)
hospitals_df.to_csv('/Users/alessandro/yellowlynx/hospitals_df.csv', index=False)

#Create unique values numpy arrays created for each variable and exported to csv files.
ClassID = hospitals_df['ClassID'].unique()
OrderID = hospitals_df['OrderID'].unique()
GroupDescriptionNames = hospitals_df['ClassName'].unique()
MeasurementUnit = hospitals_df['MeasurementUnit'].unique()
Sku = hospitals_df['SKU'].unique()
MedNames = hospitals_df['Product'].unique()
ReceiverNameUnique = hospitals_df['ReceiverName'][hospitals_df['MovementType']!='Dispensing'].unique()
FakePatientsList = hospitals_df['ReceiverName'][hospitals_df['MovementType']=='Dispensing'].unique()

pd.DataFrame(ClassID.tolist()).to_csv('/Users/alessandro/yellowlynx/ClassID.csv', index=False)
pd.DataFrame(OrderID.tolist()).to_csv('/Users/alessandro/yellowlynx/OrderID.csv', index=False)
pd.DataFrame(GroupDescriptionNames.tolist()).to_csv('/Users/alessandro/yellowlynx/groupDescNames.csv', index=False)
pd.DataFrame(MeasurementUnit.tolist()).to_csv('/Users/alessandro/yellowlynx/MeasurementUnit.csv', index=False)
pd.DataFrame(Sku.tolist()).to_csv('/Users/alessandro/yellowlynx/Sku.csv', index=False)
pd.DataFrame(MedNames.tolist()).to_csv('/Users/alessandro/yellowlynx/MedNames.csv', index=False)
pd.DataFrame(ReceiverNameUnique.tolist()).to_csv('/Users/alessandro/yellowlynx/ReceiverNameUnique.csv', index=False)
pd.DataFrame(FakePatientsList.tolist()).to_csv('/Users/alessandro/yellowlynx/FakePatientsList.csv', index=False)

#Create randomic integer or alphanumeric sequences for anonymization.
ClassIDRandomInts = [random.randint(100,999) for i in ClassID]
SkuRandomInts = [random.randint(1000,9999) for i in Sku]
ReceiverIDRandomInts = [random.randint(10000,99999) for i in ReceiverNameUnique]
OrderIDRandom = [''.join((random.choices(string.ascii_letters + string.digits,k=12))) for i in OrderID]
PatientsRandom = [''.join((random.choices(string.ascii_letters + string.digits,k=12))) for i in FakePatientsList]
pd.DataFrame(ClassIDRandomInts).to_csv('/Users/alessandro/yellowlynx/GroupIDRandomInts.csv', index=False)
pd.DataFrame(SkuRandomInts).to_csv('/Users/alessandro/yellowlynx/SkuRandomInts.csv', index=False)
pd.DataFrame(OrderIDRandom).to_csv('/Users/alessandro/yellowlynx/OrderIDRandom.csv', index=False)
pd.DataFrame(PatientsRandom).to_csv('/Users/alessandro/yellowlynx/PacientsRandom.csv', index=False)
pd.DataFrame(ReceiverIDRandomInts).to_csv('/Users/alessandro/yellowlynx/ReceiverIDRandomInts.csv', index=False)

#Create dictionaries to standardize nomenclature and perform correspondent replacements in each variable.
#Only a section of each dictionary is shown bellow.
dictSenderLocationID = {'Red Cross Hospital':'MSH2', 'West Bridge Hospital':'LGH3', 'Park Avenue Hosp':'LGH2', 'OrthoClinic':'MSH1', "Children's Hospital":'LGH1'}
dictOrderID = {'RCH014908':'0_QVTG2Q3R1MAY','RCH020827':'1904_IXYBBWHWA5G5','RCH018761':'1904_J3IF74GESI9J','RCH023155':'2000_T9QXHFMSNZXL','RCH025991':'2000_E2IMCUS7TOEA','RCH017042':'2000_YEBJKDDLRC0J','RCH43372':'2000_2LMTJZGRLMB2', ...}
dictClassID = {'09A02A':'601','09A02B':'728','09A03A':'541','09A03B':'328','09A03F':'510','09A04A':'837','09A05A':'778','09A06A':'138','09A07A':'938','09A07C':'837','09A10A':'828','09A10B':'353','09A11A':'484','09A11D':'435', ...}
dictMeasurementUnit = {'AMP ':'AMP','BS ':'TUBE','CJ ':'SET','CP ':'TBT','CS ':'CPS','DG ':'DRG','EN ':'ENV','FA ':'ABT','FR ':'BT','GL ':'GL','GR ':'GR','KT ':'SET','ML ':'ML','PT ':'PT','TB ':'TB','UM ':'UN','UN ':'UN'}
dictSku = {'0':'0','604':'5347','607':'9171','612':'3876','654':'6365','666':'4819','694':'8847','695':'9466','708':'8598','1038':'6451','2198':'2815','2280':'2327','2988':'6086','3243':'3493','3286':'3411','4350':'5764', ...}
dictGroupDesc = {' ALQUILANTES':'ALKYLATING AGENTS',' ANTIADRENÉRGICOS CENTRAIS':'ANTIADRENERGIC AGENTS, CENTRALLY ACTING',' ANTICOLINÉRGICOS':'ANTICHOLINERGICS AGENTS',' ANTIINFLAMATÓRIOS':'ANTI-INFLAMMATORY DRUGS', ...}
dictMedNames = {'ACICLOVIR 250 MG':'ACICLOVIR (SODIUM) 250 MG INJECTION, POWDER, FOR SOLUTION','ACICLOVIR 200 MG':'ACICLOVIR 200 MG TABLET','ACICLOVIR POMADA 0,03 G/G BISNAGA 4,5 G':'ACICLOVIR 0,03 G/G 4,5 G OINTMENT,OPHTHALMIC', ...}
dictReceiverName = {'Wonka Industries':'SUPPLIER','Acme Corp.':'SUPPLIER','Stark Industries':'SUPPLIER','internal_medicine_inpatient':'LGH2_INPATIENT_INTERNAL_MEDICINE',"Ollivander's Wand Shop":'SUPPLIER','Internal_Medicine_Inpatient':'LGH2_INPATIENT_INTERNAL_MEDICINE', ...}
dictReceiverID = {'LGH1_ADMINISTRATION':'26631','LGH1_ANESTHETICS':'18494','LGH1_CARDIOLOGY_OUTPATIENT':'19874','LGH1_CENTRAL_STERILE_SERVICES':'46371','LGH1_DIAGNOSTIC_IMAGING':'95463','LGH1_DIAGNOSTIC_LABORATORY':'70358', ...}

#Map columns according to dictionaries.
hospitals_df['SenderLocationID'] = hospitals_df['SenderLocationID'].map(dictSenderLocationID)
hospitals_df['OrderID'] = hospitals_df['OrderID'].map(dictOrderID)
hospitals_df['ClassID'] = hospitals_df['ClassID'].map(dictClassID)
hospitals_df['MeasurementUnit'] = hospitals_df['MeasurementUnit'].map(dictMeasurementUnit)
hospitals_df['SKU'] = hospitals_df['SKU'].map(dictSku)
hospitals_df['ClassName'] = hospitals_df['ClassName'].map(dictGroupDesc)
hospitals_df['Product'] = hospitals_df['Product'].map(dictMedNames)
hospitals_df['ReceiverName'] = hospitals_df['ReceiverName'].map(dictReceiverName)
hospitals_df['ReceiverID'] = hospitals_df['ReceiverName'].map(dictReceiverID)</code></pre> </details> <script src="https://cdn.jsdelivr.net/npm/prismjs/prism.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-python.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/line-numbers/prism-line-numbers.min.js"></script> <p><br></p> <h3 id="16-initial-data-analyses">1.6 Initial data analyses</h3> <p>This cleaned dataframe <em>hospitals_df</em> contains 16 columns and 1,797,173 rows. In addition to the extensive cleaning process, there were no missing values or duplicates.<br></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">hospitals_df</span><span class="p">.</span><span class="n">shape</span>
</code></pre></div></div> <p>(1797173, 16)<br><br></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">hospitals_df</span><span class="p">.</span><span class="nf">info</span><span class="p">()</span>
</code></pre></div></div> <caption><b>Table 2. Output of hospitals_df.info().</b></caption> <table> <thead> <tr> <th> </th> <th>Column</th> <th>Dtype</th> </tr> </thead> <tbody> <tr> <td>0</td> <td>SenderLocationID</td> <td>object</td> </tr> <tr> <td>1</td> <td>OrderID</td> <td>object</td> </tr> <tr> <td>2</td> <td>Date</td> <td>datetime64[ns]</td> </tr> <tr> <td>3</td> <td>ReceiverID</td> <td>object</td> </tr> <tr> <td>4</td> <td>ReceiverName</td> <td>object</td> </tr> <tr> <td>5</td> <td>InOut</td> <td>object</td> </tr> <tr> <td>6</td> <td>MovementType</td> <td>object</td> </tr> <tr> <td>7</td> <td>SKU</td> <td>object</td> </tr> <tr> <td>8</td> <td>Product</td> <td>object</td> </tr> <tr> <td>9</td> <td>ClassID</td> <td>object</td> </tr> <tr> <td>10</td> <td>ClassName</td> <td>object</td> </tr> <tr> <td>11</td> <td>MeasurementUnit</td> <td>object</td> </tr> <tr> <td>12</td> <td>StandartPrice</td> <td>float64</td> </tr> <tr> <td>13</td> <td>Quantity</td> <td>float64</td> </tr> <tr> <td>14</td> <td>RemainingStock</td> <td>float64</td> </tr> <tr> <td>15</td> <td>StockValue</td> <td>float64</td> </tr> </tbody> </table> <p><br></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">hospitals_df</span><span class="p">.</span><span class="nf">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</code></pre></div></div> <caption><b>Table 3. Output of hospitals_df.head().</b></caption> <table> <thead> <tr> <th style="text-align: center"> </th> <th style="text-align: center">SenderLocationID</th> <th style="text-align: center">OrderID</th> <th style="text-align: center">Date</th> <th style="text-align: center">ReceiverID</th> <th style="text-align: center">ReceiverName</th> <th style="text-align: center">InOut</th> <th style="text-align: center">MovementType</th> <th style="text-align: center">SKU</th> <th style="text-align: center">Product</th> <th style="text-align: center">ClassID</th> <th style="text-align: center">ClassName</th> <th style="text-align: center">MeasurementUnit</th> <th style="text-align: center">StandartPrice</th> <th style="text-align: center">Quantity</th> <th style="text-align: center">RemainingStock</th> <th style="text-align: center">StockValue</th> </tr> </thead> <tbody> <tr> <td style="text-align: center">0</td> <td style="text-align: center">MSH2</td> <td style="text-align: center">0590_QVTG2Q3R1MAY</td> <td style="text-align: center">2020-04-20</td> <td style="text-align: center">MSH2_PHARMACY</td> <td style="text-align: center">MSH2_PHARMACY</td> <td style="text-align: center">Out</td> <td style="text-align: center">Request</td> <td style="text-align: center">5347</td> <td style="text-align: center">BUDESONIDE 32MCG/ACTUATION 120 ACTUATIONS AERO…</td> <td style="text-align: center">295</td> <td style="text-align: center">OTHER DRUGS FOR UPPER AIRWAY OBSTRUCTION, INHA…</td> <td style="text-align: center">BT</td> <td style="text-align: center">7.571365</td> <td style="text-align: center">-1.0</td> <td style="text-align: center">0.0</td> <td style="text-align: center">7.571365</td> </tr> <tr> <td style="text-align: center">1</td> <td style="text-align: center">MSH2</td> <td style="text-align: center">1904_IXYBBWHWA5G5</td> <td style="text-align: center">2020-05-13</td> <td style="text-align: center"> </td> <td style="text-align: center">SUPPLIER</td> <td style="text-align: center">In</td> <td style="text-align: center">Restock</td> <td style="text-align: center">5347</td> <td style="text-align: center">BUDESONIDE 32MCG/ACTUATION 120 ACTUATIONS AERO…</td> <td style="text-align: center">295</td> <td style="text-align: center">OTHER DRUGS FOR UPPER AIRWAY OBSTRUCTION, INHA…</td> <td style="text-align: center">BT</td> <td style="text-align: center">7.570198</td> <td style="text-align: center">2.0</td> <td style="text-align: center">2.0</td> <td style="text-align: center">15.140395</td> </tr> <tr> <td style="text-align: center">2</td> <td style="text-align: center">MSH2</td> <td style="text-align: center">1904_J3IF74GESI9J</td> <td style="text-align: center">2020-05-14</td> <td style="text-align: center">MSH2_PHARMACY</td> <td style="text-align: center">MSH2_PHARMACY</td> <td style="text-align: center">Out</td> <td style="text-align: center">Request</td> <td style="text-align: center">5347</td> <td style="text-align: center">BUDESONIDE 32MCG/ACTUATION 120 ACTUATIONS AERO…</td> <td style="text-align: center">295</td> <td style="text-align: center">OTHER DRUGS FOR UPPER AIRWAY OBSTRUCTION, INHA…</td> <td style="text-align: center">BT</td> <td style="text-align: center">7.570198</td> <td style="text-align: center">-1.0</td> <td style="text-align: center">1.0</td> <td style="text-align: center">7.570198</td> </tr> <tr> <td style="text-align: center">3</td> <td style="text-align: center">MSH2</td> <td style="text-align: center">2000_T9QXHFMSNZXL</td> <td style="text-align: center">2020-06-08</td> <td style="text-align: center">MSH2_PHARMACY</td> <td style="text-align: center">MSH2_PHARMACY</td> <td style="text-align: center">Out</td> <td style="text-align: center">Request</td> <td style="text-align: center">5347</td> <td style="text-align: center">BUDESONIDE 32MCG/ACTUATION 120 ACTUATIONS AERO…</td> <td style="text-align: center">295</td> <td style="text-align: center">OTHER DRUGS FOR UPPER AIRWAY OBSTRUCTION, INHA…</td> <td style="text-align: center">BT</td> <td style="text-align: center">7.570198</td> <td style="text-align: center">-1.0</td> <td style="text-align: center">0.0</td> <td style="text-align: center">7.570198</td> </tr> <tr> <td style="text-align: center">4</td> <td style="text-align: center">MSH2</td> <td style="text-align: center">2000_E2IMCUS7TOEA</td> <td style="text-align: center">2020-06-08</td> <td style="text-align: center"> </td> <td style="text-align: center">SUPPLIER</td> <td style="text-align: center">In</td> <td style="text-align: center">Restock</td> <td style="text-align: center">5347</td> <td style="text-align: center">BUDESONIDE 32MCG/ACTUATION 120 ACTUATIONS AERO…</td> <td style="text-align: center">295</td> <td style="text-align: center">OTHER DRUGS FOR UPPER AIRWAY OBSTRUCTION, INHA…</td> <td style="text-align: center">BT</td> <td style="text-align: center">7.570198</td> <td style="text-align: center">2.0</td> <td style="text-align: center">2.0</td> <td style="text-align: center">15.140395</td> </tr> </tbody> </table> <p><br></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">hospitals_df</span><span class="p">.</span><span class="nf">isna</span><span class="p">().</span><span class="nf">sum</span><span class="p">()</span>
</code></pre></div></div> <caption><b>Table 4. Output of hospitals_df.isna().sum().</b></caption> <table> <thead> <tr> <th>Feature</th> <th>Sum</th> </tr> </thead> <tbody> <tr> <td>SenderLocationID</td> <td>0</td> </tr> <tr> <td>OrderID</td> <td>0</td> </tr> <tr> <td>Date</td> <td>0</td> </tr> <tr> <td>ReceiverID</td> <td>0</td> </tr> <tr> <td>ReceiverName</td> <td>0</td> </tr> <tr> <td>InOut</td> <td>0</td> </tr> <tr> <td>MovementType</td> <td>0</td> </tr> <tr> <td>SKU</td> <td>0</td> </tr> <tr> <td>Product</td> <td>0</td> </tr> <tr> <td>ClassID</td> <td>0</td> </tr> <tr> <td>ClassName</td> <td>0</td> </tr> <tr> <td>MeasurementUnit</td> <td>0</td> </tr> <tr> <td>StandartPrice</td> <td>0</td> </tr> <tr> <td>Quantity</td> <td>0</td> </tr> <tr> <td>RemainingStock</td> <td>0</td> </tr> <tr> <td>StockValue</td> <td>0</td> </tr> <tr> <td>dtype: int64</td> <td> </td> </tr> </tbody> </table> <p><br></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">hospitals_df</span><span class="p">.</span><span class="nf">duplicated</span><span class="p">().</span><span class="nf">sum</span><span class="p">()</span>
</code></pre></div></div> <p>0<br><br></p> <h3 id="161-new-columns-feature-engineering">1.6.1 New columns/ feature engineering</h3> <p>A new variable was created to assign a stock value for each row in the dataset.<br> Year, month and quarter columns where also added.<br> Additional features were designed later on.</p> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <title>Your Page Title</title> <link href="https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-material-dark.min.css" rel="stylesheet"> <details> <summary><b>Click to expand/collapse code</b></summary> <pre class="line-numbers"><code class="language-python">#Create a month column
hospitals_df['month'] = hospitals_df['Date'].dt.month.apply(lambda x: f'{x:02d}')

#Create a year column
hospitals_df['year'] = hospitals_df['Date'].dt.year

#Create a year_month column
hospitals_df['year_month'] = hospitals_df['Date'].dt.strftime('%Y-%m')

#Create a quarter column
hospitals_df['quarter'] = hospitals_df['Date'].dt.quarter

#Create a year-quarter column
hospitals_df['year_quarter'] = pd.PeriodIndex(hospitals_df['Date'], freq='Q')

#Create a column referencing the stock value of every ocurrence.
hospitals_df['StockValue'] = abs(hospitals_df['StandartPrice']*hospitals_df['Quantity'])</code></pre> </details> <script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-python.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/line-numbers/prism-line-numbers.min.js"></script> <p><br></p> <p>Thats it for now!</p> <p>In the <a href="/projects/2_project/">second section</a>, I will focus on the <strong>exploratory data analysis (EDA)</strong> and <strong>data visualization</strong>.</p> <hr> </div> </article> </div> </div> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2025 Alessandro O. Sousa. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="/assets/js/bootstrap-toc.min.js?c82ff4de8b0955d6ff14f5b05eed7eb6"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>